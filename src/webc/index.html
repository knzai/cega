<!doctype html>
<html lang="en">
<head>
   <link data-trunk rel="css" href="./styles.css" />
   <link 
   data-trunk 
   rel="rust" href="../../Cargo.toml"
   data-bin="cega-webc" 
   data-cargo-no-default-features 
   data-cargo-features="webc"
   />
   <script>
      const fileReader = new FileReader();
      fileReader.onloadend = function() {
         let array = new Int8Array(fileReader.result);
         let images = window.wasmBindings.previews(array);
         images.forEach(makePreview);
      }
      document.addEventListener("DOMContentLoaded", () => {
         const fileInput = document.getElementById('file-input');
         fileInput.addEventListener("change", e => fileReader.readAsArrayBuffer(fileInput.files[0]));
      });

      function makePreview(src) {
         const template = document.querySelector("#preview");
         const clone = template.content.cloneNode(true);
         const container = document.querySelector(".preview-area");
         let img = clone.querySelector("img");
         img.src=src;
         container.appendChild(img);
      }
</script>
</head>
<body>
   <h1>Process your CGA/EGAs</h1>
   <input id="file-input" multiple="false" type="file" accept=".bin,.cga,.ega,.cega" />
   <div class="preview-area"></div>
   <template id="preview"><img class="preview" src="" /></template>
</body>
</html>